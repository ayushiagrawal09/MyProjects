using Microsoft.Azure.Management.Monitor;
using Microsoft.Azure.Management.Monitor.Models;
//using Microsoft.Azure.Management.ResourceManager.Fluent;
//using Microsoft.Azure.Management.ResourceManager.Fluent.Models;
using ResourceManagementClient = Microsoft.Azure.Management.ResourceManager.ResourceManagementClient;
using Microsoft.Rest;
using Microsoft.Rest.Azure.OData;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Security.AccessControl;
using System.Text;
using System.Threading.Tasks;
using Microsoft.Azure.Management.ResourceManager.Models;
using Microsoft.Azure.Management.ResourceManager;

namespace ConsoleApp3
{
    internal class Program
    {
        static void Main(string[] args)
        {

            //String Audittoken = "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ii1LSTNROW5OUjdiUm9meG1lWm9YcWJIWkdldyIsImtpZCI6Ii1LSTNROW5OUjdiUm9meG1lWm9YcWJIWkdldyJ9.eyJhdWQiOiJodHRwczovL21hbmFnZW1lbnQuY29yZS53aW5kb3dzLm5ldC8iLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC8zM2UwMTkyMS00ZDY0LTRmOGMtYTA1NS01YmRhZmZkNWUzM2QvIiwiaWF0IjoxNjczNjAxOTgyLCJuYmYiOjE2NzM2MDE5ODIsImV4cCI6MTY3MzYwNzU5OSwiYWNyIjoiMSIsImFpbyI6IkFWUUFxLzhUQUFBQTVXWndURUwxa2RCQ2JmdXN2Q28rRUpZTVpJK2JtR3NkcGZkUk9HSUpHOGduWHU2NWJFVFE3MDBvZWxwTmNyaE1xUWdOdGhHeGZORWV2L1hBbmtieXFNenlrdlhIV2JjQzg2cFZTR3Fpa2t3PSIsImFtciI6WyJyc2EiLCJtZmEiXSwiYXBwaWQiOiJjNDRiNDA4My0zYmIwLTQ5YzEtYjQ3ZC05NzRlNTNjYmRmM2MiLCJhcHBpZGFjciI6IjIiLCJkZXZpY2VpZCI6ImNhNjEzYzc0LWIwNGYtNGIxMS1hZDhkLTM0ZTkwY2MxN2QxNCIsImZhbWlseV9uYW1lIjoiUmF0bmFtIiwiZ2l2ZW5fbmFtZSI6IlJpdGVzaCBHb3VkIiwiZ3JvdXBzIjpbImI5N2U5NzAxLTkyZjQtNDIwYy1iOGE2LTc5M2VlYTc4ZWIyZiIsIjgzZjEyMTE2LWUzYjEtNGQ5YS05OTM5LWIyZTU5YmJjZTNlMSIsImMyMGZiYzE5LTNjMTYtNDE4Ni04M2VmLWFhZWE0YzZjYmQwYyIsIjQ3NmVhZjM0LWM2MjItNDMwZC1hNzdkLTZkMjU0NjkxMDE5YiIsImNiMDhjODM2LTgwYzAtNGMyYy1iYmQ1LWUxODYzMWNhMjBjNSIsImY3OTBhNjM4LTA2OTQtNDUzNy1iZDFjLTYwZDg2MzU1Y2NlOSIsIjhlZGZiZjM5LWQyODgtNDVlNS04OTcyLTRjMzMzNjc4ZDQ0YSIsImJjMzExZTNiLTMyNjUtNDhkZS05NGFlLTQ3ZjdiMDNlYTlhNCIsImZhMGVhZTQyLTdkNWItNGVkNi1iNjZlLTk1MjMyMTUxNTAwYyIsIjcwNDk1ZDQ5LTU0NTUtNGY4Zi1hMjRhLTczYzY2ODE3NDY4YiIsImUyOWQ2OTUyLTJiYWUtNGZkYS1iN2ZlLTRmN2JkMmU1Yzg2MiIsImM4ZGFmNjU1LWFiYTYtNDAyMy05MDhiLTJhMDI3OTllNWJiYyIsImQyOGFhMTc1LTIwNzItNDg5Yy1hN2JhLTA0ZDAxMjNhMjExNyIsIjA1NDQzOTg2LTFjZmEtNDk3My1iZmUzLTRiMTQzZjNiYzJmOSIsIjgxNmZjNDg5LTY5YTItNDY4Zi05MjRlLWM5ZDJkZmFjZjUzNCIsIjY2ZWU5Yzk0LWNiZWEtNDhiNy05MGYwLTA0NTIyZmQ2MjNjNCIsIjZhZTFlMzlhLTNkN2UtNDIxZi1hOWFiLTdkOGI5MGZhMGJhYiIsIjc3OGJiZjliLTg2NGUtNGU2Ny1hZDg5LTUzZWFlNTQyZjNkNSIsIjkwYzMwMzllLTk1YzgtNDI3Zi04Y2VjLWU0YzEwZmZkNjZlZCIsImQ1N2JlYWE5LTcxZmItNGI2Yy05Njc4LWU2ZWZhYzJlMjg4MyIsIjJiYzFjZGIwLWE1NWQtNDg5Ny05NTMzLTMyYWNmYWEzYzllYiIsIjQzNjE3NmI2LWEzYTEtNGI5OS1iYmZlLTFjNjg1MmE2ZDFmMCIsIjZmYmZmMmJjLWE0M2MtNDk5ZS05MDQyLTI4MGQ5Yzc1YTlkZiIsImRlNTIyMWM0LTk1MzMtNDhlZS05NDMxLTE3YzU2MjFkMGMyZSIsImYzZmE0OWM0LTg3MmUtNDBkNi05YTQwLWFjODdmNTA3MTdlNiIsIjM2OGM5M2NlLTY2MGYtNDM1OC1iMGJjLWNiYzRjMTI2NzI4MiIsIjJjNjA4NGQwLTQ5NzktNGVjMy1hNDk3LWI1ZjI5YjY4ODZkZCIsImZjYzhmNmQ3LTk4NjUtNDRlYS05OTlmLTYyMzQwYTU4Yzc4NyIsIjQzNTE1ZGRhLWRhMjUtNGNlMi1hZjYzLWYyZmI2YjUxNzVhZCIsIjM5ZTFjYWU1LTA4YTUtNDU0Mi04ZWI5LWJmZDYwNzA2Njk0MyIsImZkYjMzNGU3LThmYjUtNDNkOC04ZjIwLTk1OGE3NTQ5ZmQxZiIsIjZkN2QyNWZmLTBmZjctNGU3ZC05MDIwLTliNDYwNGYyNjQzZiJdLCJpcGFkZHIiOiIxMy4xMDYuNC4xMjYiLCJuYW1lIjoiUml0ZXNoIEdvdWQgUmF0bmFtIChWLVJSQVROQU0pIiwib2lkIjoiMDAyYjJlNGItNWQ1My00MjI0LThkYTUtNmM2YjdkN2FmMGYwIiwib25wcmVtX3NpZCI6IlMtMS01LTIxLTQxMjk4NjgyMjUtMTMyODU4MTEyNi0zODk3NTcxNDQ2LTEzNDYxMCIsInB1aWQiOiIxMDAzMjAwMjA1Njg2M0MxIiwicmgiOiIwLkFUTUFJUm5nTTJSTmpFLWdWVnZhXzlYalBVWklmM2tBdXRkUHVrUGF3ZmoyTUJNekFBRS4iLCJzY3AiOiJ1c2VyX2ltcGVyc29uYXRpb24iLCJzdWIiOiJtNG5uSWZCOFVRdTJTYllyUVotTzJfLVBQcWNYVTFvTVJuV1diUTdaRVdnIiwidGlkIjoiMzNlMDE5MjEtNGQ2NC00ZjhjLWEwNTUtNWJkYWZmZDVlMzNkIiwidW5pcXVlX25hbWUiOiJWLVJSQVROQU1AYW1lLmdibCIsInVwbiI6IlYtUlJBVE5BTUBhbWUuZ2JsIiwidXRpIjoiZ0dBbzJMei1BVXlIYzI2WlJaU1pBUSIsInZlciI6IjEuMCIsInhtc190Y2R0IjoxNDYxMjE0NDAyfQ.jrQhkWCxeTuAFfG2tw0ePmw1_QafPlutJ7Ag6FtdKhh3PfZUUnUzYzKIeL9Zdv5mDINigyk8uB7BTX1DGGh7AqKAv28RuddhMKkg9ZhlcLToKftK3Xsj_p8d7NPsq_XXTL24vpPB33XMdfUMJCL6iGqk05c0NRMUfs5dwDk6ruRPfIl3R8qFmXevpY8VVOGsFP3aBUkjoFHZUaf5iDj5WmDwhh7BmsW-VnD-QCqEqwCwbzXp1XDkKHnFnUpm5iXXuiOADW1ZcCPCkJtMETIJAjw47nXO_pqbAHGY9W6P0B0tqxMswP_DSBbKZ7iVLQoIgbtk9MVuqZeVgvTAb8bUyA";
            //String token = "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ii1LSTNROW5OUjdiUm9meG1lWm9YcWJIWkdldyIsImtpZCI6Ii1LSTNROW5OUjdiUm9meG1lWm9YcWJIWkdldyJ9.eyJhdWQiOiJodHRwczovL21hbmFnZW1lbnQuY29yZS53aW5kb3dzLm5ldC8iLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC8zM2UwMTkyMS00ZDY0LTRmOGMtYTA1NS01YmRhZmZkNWUzM2QvIiwiaWF0IjoxNjczNjA3MDE5LCJuYmYiOjE2NzM2MDcwMTksImV4cCI6MTY3MzYxMTE4NiwiYWNyIjoiMSIsImFpbyI6IkFWUUFxLzhUQUFBQVYvZFhUZzE5QXJpcFdEQ3g4YTNUK1VCVUppUDg2TmsxMlVCWHZTVnM3MUJteXVnaS9FSEw2NzNOMUdNdlM3VUJFQ2dPK2ExbVNoM2ZoSnRNajFwVEpWamdyM0tIbnl6K2phTXhVRGRpSHgwPSIsImFtciI6WyJyc2EiLCJtZmEiXSwiYXBwaWQiOiJjNDRiNDA4My0zYmIwLTQ5YzEtYjQ3ZC05NzRlNTNjYmRmM2MiLCJhcHBpZGFjciI6IjIiLCJkZXZpY2VpZCI6ImNhNjEzYzc0LWIwNGYtNGIxMS1hZDhkLTM0ZTkwY2MxN2QxNCIsImZhbWlseV9uYW1lIjoiUmF0bmFtIiwiZ2l2ZW5fbmFtZSI6IlJpdGVzaCBHb3VkIiwiZ3JvdXBzIjpbImI5N2U5NzAxLTkyZjQtNDIwYy1iOGE2LTc5M2VlYTc4ZWIyZiIsIjgzZjEyMTE2LWUzYjEtNGQ5YS05OTM5LWIyZTU5YmJjZTNlMSIsImMyMGZiYzE5LTNjMTYtNDE4Ni04M2VmLWFhZWE0YzZjYmQwYyIsIjQ3NmVhZjM0LWM2MjItNDMwZC1hNzdkLTZkMjU0NjkxMDE5YiIsImNiMDhjODM2LTgwYzAtNGMyYy1iYmQ1LWUxODYzMWNhMjBjNSIsImY3OTBhNjM4LTA2OTQtNDUzNy1iZDFjLTYwZDg2MzU1Y2NlOSIsIjhlZGZiZjM5LWQyODgtNDVlNS04OTcyLTRjMzMzNjc4ZDQ0YSIsImJjMzExZTNiLTMyNjUtNDhkZS05NGFlLTQ3ZjdiMDNlYTlhNCIsImZhMGVhZTQyLTdkNWItNGVkNi1iNjZlLTk1MjMyMTUxNTAwYyIsIjcwNDk1ZDQ5LTU0NTUtNGY4Zi1hMjRhLTczYzY2ODE3NDY4YiIsImUyOWQ2OTUyLTJiYWUtNGZkYS1iN2ZlLTRmN2JkMmU1Yzg2MiIsImM4ZGFmNjU1LWFiYTYtNDAyMy05MDhiLTJhMDI3OTllNWJiYyIsImQyOGFhMTc1LTIwNzItNDg5Yy1hN2JhLTA0ZDAxMjNhMjExNyIsIjA1NDQzOTg2LTFjZmEtNDk3My1iZmUzLTRiMTQzZjNiYzJmOSIsIjgxNmZjNDg5LTY5YTItNDY4Zi05MjRlLWM5ZDJkZmFjZjUzNCIsIjY2ZWU5Yzk0LWNiZWEtNDhiNy05MGYwLTA0NTIyZmQ2MjNjNCIsIjZhZTFlMzlhLTNkN2UtNDIxZi1hOWFiLTdkOGI5MGZhMGJhYiIsIjc3OGJiZjliLTg2NGUtNGU2Ny1hZDg5LTUzZWFlNTQyZjNkNSIsIjkwYzMwMzllLTk1YzgtNDI3Zi04Y2VjLWU0YzEwZmZkNjZlZCIsImQ1N2JlYWE5LTcxZmItNGI2Yy05Njc4LWU2ZWZhYzJlMjg4MyIsIjJiYzFjZGIwLWE1NWQtNDg5Ny05NTMzLTMyYWNmYWEzYzllYiIsIjQzNjE3NmI2LWEzYTEtNGI5OS1iYmZlLTFjNjg1MmE2ZDFmMCIsIjZmYmZmMmJjLWE0M2MtNDk5ZS05MDQyLTI4MGQ5Yzc1YTlkZiIsImRlNTIyMWM0LTk1MzMtNDhlZS05NDMxLTE3YzU2MjFkMGMyZSIsImYzZmE0OWM0LTg3MmUtNDBkNi05YTQwLWFjODdmNTA3MTdlNiIsIjM2OGM5M2NlLTY2MGYtNDM1OC1iMGJjLWNiYzRjMTI2NzI4MiIsIjJjNjA4NGQwLTQ5NzktNGVjMy1hNDk3LWI1ZjI5YjY4ODZkZCIsImZjYzhmNmQ3LTk4NjUtNDRlYS05OTlmLTYyMzQwYTU4Yzc4NyIsIjQzNTE1ZGRhLWRhMjUtNGNlMi1hZjYzLWYyZmI2YjUxNzVhZCIsIjM5ZTFjYWU1LTA4YTUtNDU0Mi04ZWI5LWJmZDYwNzA2Njk0MyIsImZkYjMzNGU3LThmYjUtNDNkOC04ZjIwLTk1OGE3NTQ5ZmQxZiIsIjZkN2QyNWZmLTBmZjctNGU3ZC05MDIwLTliNDYwNGYyNjQzZiJdLCJpcGFkZHIiOiIxMy4xMDYuNC4xMjYiLCJuYW1lIjoiUml0ZXNoIEdvdWQgUmF0bmFtIChWLVJSQVROQU0pIiwib2lkIjoiMDAyYjJlNGItNWQ1My00MjI0LThkYTUtNmM2YjdkN2FmMGYwIiwib25wcmVtX3NpZCI6IlMtMS01LTIxLTQxMjk4NjgyMjUtMTMyODU4MTEyNi0zODk3NTcxNDQ2LTEzNDYxMCIsInB1aWQiOiIxMDAzMjAwMjA1Njg2M0MxIiwicmgiOiIwLkFUTUFJUm5nTTJSTmpFLWdWVnZhXzlYalBVWklmM2tBdXRkUHVrUGF3ZmoyTUJNekFBRS4iLCJzY3AiOiJ1c2VyX2ltcGVyc29uYXRpb24iLCJzdWIiOiJtNG5uSWZCOFVRdTJTYllyUVotTzJfLVBQcWNYVTFvTVJuV1diUTdaRVdnIiwidGlkIjoiMzNlMDE5MjEtNGQ2NC00ZjhjLWEwNTUtNWJkYWZmZDVlMzNkIiwidW5pcXVlX25hbWUiOiJWLVJSQVROQU1AYW1lLmdibCIsInVwbiI6IlYtUlJBVE5BTUBhbWUuZ2JsIiwidXRpIjoiY1FpMWh3NlFoa1dGUmZib3o3dFFBQSIsInZlciI6IjEuMCIsInhtc190Y2R0IjoxNDYxMjE0NDAyfQ.qUEJWw-npTcIAmijNfwirspGVO2Ag_2KZ9ErI1hUCZMZsIpL8NcLItX0uuho6vkuKd4RGAo17imC-cgVgOjHVsxQn9AVHEBqKzgZ-eQFfzYNPSeXmBu8H3Rl4LosngCIJrLsxZBYboDlNYItyoSkpa-Em50ZYRZ5bexqbv53b0JvRtmtagg1oPMqtiYDnA2UlHlqlWlhnHhmIpK3fZMZO7Y7lItCDEH7pT8J1JLQr0eP2dHmA-HZWkrsnj7qHYR0rls7ecJHWJ4m9PNAHtXv41XMASMvBU69nYrC8ViUSY01jLneWU9J9huw0x50YEedg5o-a_ussHAdIBXhOgCnyA";
            String token = "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ii1LSTNROW5OUjdiUm9meG1lWm9YcWJIWkdldyIsImtpZCI6Ii1LSTNROW5OUjdiUm9meG1lWm9YcWJIWkdldyJ9.eyJhdWQiOiJodHRwczovL21hbmFnZW1lbnQuY29yZS53aW5kb3dzLm5ldC8iLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC8zM2UwMTkyMS00ZDY0LTRmOGMtYTA1NS01YmRhZmZkNWUzM2QvIiwiaWF0IjoxNjc0MTkxMDY1LCJuYmYiOjE2NzQxOTEwNjUsImV4cCI6MTY3NDE5NTg5OCwiYWNyIjoiMSIsImFpbyI6IkFWUUFxLzhUQUFBQXR5ZDM0NldYRkxCNGJwYTNRREc5bGgveU1PUEpSUGpaUmxyTjhlcndWcGxGbXZGaXhZcTJHbXlIS0M4OTBQQ2psY0dDcDFPaXpqbHA2KzZxRHlONXJxYkJtT00yRGNtZWFRMUpFWUZaYW5NPSIsImFtciI6WyJyc2EiLCJtZmEiXSwiYXBwaWQiOiJjNDRiNDA4My0zYmIwLTQ5YzEtYjQ3ZC05NzRlNTNjYmRmM2MiLCJhcHBpZGFjciI6IjIiLCJkZXZpY2VpZCI6ImNhNjEzYzc0LWIwNGYtNGIxMS1hZDhkLTM0ZTkwY2MxN2QxNCIsImZhbWlseV9uYW1lIjoiUmF0bmFtIiwiZ2l2ZW5fbmFtZSI6IlJpdGVzaCBHb3VkIiwiZ3JvdXBzIjpbImI5N2U5NzAxLTkyZjQtNDIwYy1iOGE2LTc5M2VlYTc4ZWIyZiIsIjgzZjEyMTE2LWUzYjEtNGQ5YS05OTM5LWIyZTU5YmJjZTNlMSIsImMyMGZiYzE5LTNjMTYtNDE4Ni04M2VmLWFhZWE0YzZjYmQwYyIsIjQ3NmVhZjM0LWM2MjItNDMwZC1hNzdkLTZkMjU0NjkxMDE5YiIsImNiMDhjODM2LTgwYzAtNGMyYy1iYmQ1LWUxODYzMWNhMjBjNSIsImY3OTBhNjM4LTA2OTQtNDUzNy1iZDFjLTYwZDg2MzU1Y2NlOSIsIjhlZGZiZjM5LWQyODgtNDVlNS04OTcyLTRjMzMzNjc4ZDQ0YSIsImJjMzExZTNiLTMyNjUtNDhkZS05NGFlLTQ3ZjdiMDNlYTlhNCIsImZhMGVhZTQyLTdkNWItNGVkNi1iNjZlLTk1MjMyMTUxNTAwYyIsIjcwNDk1ZDQ5LTU0NTUtNGY4Zi1hMjRhLTczYzY2ODE3NDY4YiIsImUyOWQ2OTUyLTJiYWUtNGZkYS1iN2ZlLTRmN2JkMmU1Yzg2MiIsImM4ZGFmNjU1LWFiYTYtNDAyMy05MDhiLTJhMDI3OTllNWJiYyIsImQyOGFhMTc1LTIwNzItNDg5Yy1hN2JhLTA0ZDAxMjNhMjExNyIsIjA1NDQzOTg2LTFjZmEtNDk3My1iZmUzLTRiMTQzZjNiYzJmOSIsIjgxNmZjNDg5LTY5YTItNDY4Zi05MjRlLWM5ZDJkZmFjZjUzNCIsIjY2ZWU5Yzk0LWNiZWEtNDhiNy05MGYwLTA0NTIyZmQ2MjNjNCIsIjZhZTFlMzlhLTNkN2UtNDIxZi1hOWFiLTdkOGI5MGZhMGJhYiIsIjc3OGJiZjliLTg2NGUtNGU2Ny1hZDg5LTUzZWFlNTQyZjNkNSIsIjkwYzMwMzllLTk1YzgtNDI3Zi04Y2VjLWU0YzEwZmZkNjZlZCIsImQ1N2JlYWE5LTcxZmItNGI2Yy05Njc4LWU2ZWZhYzJlMjg4MyIsIjJiYzFjZGIwLWE1NWQtNDg5Ny05NTMzLTMyYWNmYWEzYzllYiIsIjQzNjE3NmI2LWEzYTEtNGI5OS1iYmZlLTFjNjg1MmE2ZDFmMCIsIjZmYmZmMmJjLWE0M2MtNDk5ZS05MDQyLTI4MGQ5Yzc1YTlkZiIsImRlNTIyMWM0LTk1MzMtNDhlZS05NDMxLTE3YzU2MjFkMGMyZSIsImYzZmE0OWM0LTg3MmUtNDBkNi05YTQwLWFjODdmNTA3MTdlNiIsIjM2OGM5M2NlLTY2MGYtNDM1OC1iMGJjLWNiYzRjMTI2NzI4MiIsIjJjNjA4NGQwLTQ5NzktNGVjMy1hNDk3LWI1ZjI5YjY4ODZkZCIsImZjYzhmNmQ3LTk4NjUtNDRlYS05OTlmLTYyMzQwYTU4Yzc4NyIsIjQzNTE1ZGRhLWRhMjUtNGNlMi1hZjYzLWYyZmI2YjUxNzVhZCIsIjM5ZTFjYWU1LTA4YTUtNDU0Mi04ZWI5LWJmZDYwNzA2Njk0MyIsImZkYjMzNGU3LThmYjUtNDNkOC04ZjIwLTk1OGE3NTQ5ZmQxZiIsIjZkN2QyNWZmLTBmZjctNGU3ZC05MDIwLTliNDYwNGYyNjQzZiJdLCJpcGFkZHIiOiIxMy4xMDYuNC4xMjAiLCJuYW1lIjoiUml0ZXNoIEdvdWQgUmF0bmFtIChWLVJSQVROQU0pIiwib2lkIjoiMDAyYjJlNGItNWQ1My00MjI0LThkYTUtNmM2YjdkN2FmMGYwIiwib25wcmVtX3NpZCI6IlMtMS01LTIxLTQxMjk4NjgyMjUtMTMyODU4MTEyNi0zODk3NTcxNDQ2LTEzNDYxMCIsInB1aWQiOiIxMDAzMjAwMjA1Njg2M0MxIiwicmgiOiIwLkFUTUFJUm5nTTJSTmpFLWdWVnZhXzlYalBVWklmM2tBdXRkUHVrUGF3ZmoyTUJNekFBRS4iLCJzY3AiOiJ1c2VyX2ltcGVyc29uYXRpb24iLCJzdWIiOiJtNG5uSWZCOFVRdTJTYllyUVotTzJfLVBQcWNYVTFvTVJuV1diUTdaRVdnIiwidGlkIjoiMzNlMDE5MjEtNGQ2NC00ZjhjLWEwNTUtNWJkYWZmZDVlMzNkIiwidW5pcXVlX25hbWUiOiJWLVJSQVROQU1AYW1lLmdibCIsInVwbiI6IlYtUlJBVE5BTUBhbWUuZ2JsIiwidXRpIjoiTV9CTTMtMlUtVXVPRW5TWHM1bHRBQSIsInZlciI6IjEuMCIsInhtc190Y2R0IjoxNDYxMjE0NDAyfQ.qyV8703U4C6HmU9GKf0kJ0LRzk3cO5DLzOjb8X8Znw5MPnoPM2JO5K9GLEVlnLeImalLqDxBupP4jgPHVD1zoeGxy_OSQ-F0rjGQxm0RyVT_PEh5DB8tkQPtDvWQUKVaZFTYDRiEhObaIXmoBn83_kqT2hT4XS9OEkYeyW98KhCMbcaKxeX_vee-hDpEU0Gy4iwEqRvv_4tDlj6pwHKD1arI2Fmn52dl1IxzvpWyiNLwSZMx0-ayKWRinhPtez2TLj7gjq_y1fnQBUJswlz3IfcplQQM2qUZpGNsERAMU7fdWSKVvlkAq85q20r0-KZc08K5vpsQ9eOTg2gJmBd39g";
            var credentials = new TokenCredentials(token);
            MonitorManagementClient m_monitorManagementClient = new MonitorManagementClient(credentials);
            Program obj = new Program();
            ResourceManagementClient m_resourceManagementClient = new ResourceManagementClient(credentials);
            //Audit
            //m_resourceManagementClient.SubscriptionId = "d81cfd75-01da-4d43-a56e-dd649cd7d5bb";
            //DI
            m_resourceManagementClient.SubscriptionId = "84a38c6e-5ba9-475a-8822-10265a990098";
            var resources= m_resourceManagementClient.Resources.List(new ODataQuery<GenericResourceFilter>(x => x.ResourceType == "Microsoft.ServiceBus/namespaces"));
            obj.callMetricList(m_monitorManagementClient);
        }
        void callMetricList(MonitorManagementClient obj)
        {
            try
            {
//audit
                //var s_AD = obj.Metrics.List(
                //                resourceUri: "/subscriptions/d81cfd75-01da-4d43-a56e-dd649cd7d5bb/resourceGroups/aspfeus2c/providers/Microsoft.ServiceBus/namespaces/aspfeus2c",
                //                timespan: $"2023-01-8T09:09:52Z/2023-01-13T10:09:52Z",
                //                interval: TimeSpan.FromMinutes(1),
                //                //metricnames: "IncomingMessages",
                //                metricnames: "SuccessfulRequests,ServerErrors,UserErrors,ThrottledRequests,IncomingRequests,IncomingMessages,OutgoingMessages,ActiveConnections,Size,Messages,ActiveMessages",
                //                aggregation: "Average,Minimum,Maximum,Total",
                //                resultType: ResultType.Data
                //                );

                //dataimport
                var s_DI = obj.Metrics.List(
                                resourceUri: "/subscriptions/84a38c6e-5ba9-475a-8822-10265a990098/resourceGroups/disprodwus21/providers/Microsoft.ServiceBus/namespaces/disprodwus21",
                                timespan: $"2023-01-8T09:09:52Z/2023-01-13T10:09:52Z",
                                interval: TimeSpan.FromMinutes(1),
                                //metricnames: "Size",
                                metricnames: "SuccessfulRequests,ServerErrors,UserErrors,ThrottledRequests,IncomingRequests,IncomingMessages,OutgoingMessages,ActiveConnections,Size,Messages,ActiveMessages",
                                aggregation: "Average,Minimum,Maximum,Total",
                                resultType: ResultType.Data
                                );
   
                Console.WriteLine("Output" + s_DI);
                Console.ReadLine();
            }
            catch (Exception ex) {
            }

          
        }
    }
}
